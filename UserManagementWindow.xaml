<Window x:Class="UserManagementTestApp.UserManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:UserManagementTestApp"
        xmlns:vm="clr-namespace:UserManagementTestApp.ViewModels"
        xmlns:helpers="clr-namespace:UserManagementTestApp.Helpers"
        mc:Ignorable="d"
        Title="사용자 관리" Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        Background="#1E2328">

    <Window.DataContext>
        <vm:UserManagementViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- 기존 스타일 그대로 유지 -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#2D343C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#4A5562"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        <Style TargetType="PasswordBox">
            <Setter Property="Background" Value="#2D343C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#4A5562"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#174A6F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#226494"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="#A0AAB5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="#2D343C"/>
            <Setter Property="RowBackground" Value="#2D343C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#4A5562"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#4A5562"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
        </Style>
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#174A6F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
        <Style TargetType="DataGridCell">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#226494"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Title -->
            <RowDefinition Height="*"/>    <!-- List -->
            <RowDefinition Height="Auto"/> <!-- List Buttons -->
            <RowDefinition Height="Auto"/> <!-- Detail Title -->
            <RowDefinition Height="Auto"/> <!-- Detail Form -->
            <RowDefinition Height="Auto"/> <!-- Apply Button -->
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Text="사용자 목록" Foreground="White" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

        <!-- User List (Binding Users) -->
        <DataGrid Grid.Row="1" ItemsSource="{Binding Users}" SelectedItem="{Binding SelectedUser}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="사용자명" Binding="{Binding Name}" Width="*"/>
                <DataGridTextColumn Header="사번" Binding="{Binding EmployeeNumber}" Width="*"/>
                <DataGridTextColumn Header="부서" Binding="{Binding Department}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- List Buttons (Binding Commands) -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,20">
            <Button Content="추가" Width="100" Margin="0,0,10,0" Command="{Binding AddCommand}"/>
            <Button Content="삭제" Width="80" Command="{Binding DeleteCommand}"/>
        </StackPanel>

        <!-- Detail Title -->
        <TextBlock Grid.Row="3" Text="사용자 상세정보" Foreground="White" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

        <!-- Detail Form (Binding UserForm.* properties) -->
        <Border Grid.Row="4" Background="#1A1F24" BorderBrush="#4A5562" BorderThickness="1" Padding="20">
            <Grid IsEnabled="{Binding IsFormEnabled}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="사용자 ID"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding UserForm.Id, UpdateSourceTrigger=PropertyChanged}" 
                         IsEnabled="{Binding IsIdEnabled}" Margin="0,0,0,10"/>

                <Label Grid.Row="1" Content="사용자명"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding UserForm.Name, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10"/>

                <Label Grid.Row="2" Content="사번"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding UserForm.EmployeeNumber, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10"/>

                <Label Grid.Row="3" Content="부서"/>
                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding UserForm.Department, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10"/>

                <Label Grid.Row="4" Content="비밀번호"/>
                <PasswordBox Grid.Row="4" Grid.Column="1" Margin="0,0,0,10"
                             helpers:BindablePasswordHelper.Password="{Binding UserForm.Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <Label Grid.Row="5" Content="비밀번호 확인"/>
                <PasswordBox Grid.Row="5" Grid.Column="1" Margin="0,0,0,10"
                             helpers:BindablePasswordHelper.Password="{Binding UserForm.ConfirmPassword, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </Grid>
        </Border>

        <!-- Error Message Display -->
        <TextBlock Grid.Row="5" Text="{Binding ErrorMessage}" 
                   Foreground="#E74C3C" 
                   FontSize="13"
                   TextWrapping="Wrap"
                   Margin="0,10,0,5"
                   HorizontalAlignment="Center"
                   Visibility="{Binding ErrorMessage, Converter={x:Null}}">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ErrorMessage}" Value="">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ErrorMessage}" Value="{x:Null}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>

        <!-- Apply Button -->
        <Button Grid.Row="5" Content="{Binding ApplyButtonText}" Height="40" Margin="0,20,0,0" 
                Command="{Binding ApplyCommand}" Background="#226494" FontSize="16" FontWeight="SemiBold"/>

    </Grid>
</Window>
